---
title: 行为型-状态模式
tags:
  - 设计模式
categories: 基础
copyright: true
---

只要对象有状态就适合这个模式，他就是把每个状态变更时封到不同的类中，修改状态的代码封装到context类中，这样变更状态就会自动执行对应的代码，主要解决当一个对象的转换条件国语复杂的时候，把判断状态的逻辑转移到表示不同状态的一系列类中，如果状态很简单就没必要用这个模式了。

类图：
![状态模式](https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/状态模式.png)

```java
/**
 * 抽象状态类
 */
public abstract class State {
    public abstract void handle(Context context);
}

/**
 * 具体状态类
 */
public class ConcreteStateA extends State {
    @Override
    public void handle(Context context) {
        // 设置下一个状态是ConcreteStateB
        context.setState(new ConcreteStateB());
    }
}

/**
 * 具体状态类
 */
public class ConcreteStateB extends State {
    @Override
    public void handle(Context context) {
        // 设置下一个状态是ConcreteStateA
        context.setState(new ConcreteStateA());
    }

public class Context {
    private State state;

    public Context(State state) {
        this.state = state;
    }

    public void setState(State state) {
        System.out.println("当前状态" + state.getClass().getName());
        this.state = state;
    }

    public State getState() {
        return this.state;
    }

    public void request() {
        state.handle(this);
    }
}

/**
 * 客户端代码
 */
public void main(String[] args) {
    Context c = new Context(new ConcreteStateA());
    // 不断请求，同时改变状态
    c.request();
    c.request();
    c.request();
    c.request();
    c.request();
}
```

当一个对象的行为取决于他的状态，并且必须在运行时根据状态改变行为时，可以考虑状态模式了。主要就是为了消除大量的if分支。
