---
title: 结构型-享元模式
tags:
  - 设计模式
categories: 基础
copyright: true
---

![享元模式](https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/享元模式.png)

就是缓存，把对象都存起来，以后用到的时候都是一个实例，需要注意一下并发安全。

```java
public abstract class FlyWeight {
    public abstract void operation(int extrinsicstate);
}

public class ConcreteFlyWeight extends FlyWeight {
    @Override
    public void operation(int extrinsicstate) {
        System.out.printLn("具体FlyWeight:" + extrinsicstate);
    }
}

public class UnsharedConcreteFlyWeight extends FlyWeight {
    @Override
    public void operation(int extrinsicstate) {
        System.out.printLn("不共享的具体FlyWeight:" + extrinsicstate);
    }
}

public class FlyWeightFactory {
    private HashTable flyWeights = new HashTable();
    
    public FlyWeightFactory() {
        // 什么时候初始化看情况，
        flyWeights.add("x", new ConcreteFlyWeight());
        flyWeights.add("y", new ConcreteFlyWeight());
        flyWeights.add("z", new ConcreteFlyWeight());
    }
    
    public FlyWeight getFlyWeight(String key) {
        return (FlyWeight) flyWeights.get(key);
    }
}

public static void main(String[] args) {
    int extrinsicstate = 22;
    FlyWeightFactory f = new FlyWeightFactory();
    
    FlyWeight fx = f.getFlyWeight("x");
    fx.operation(--extrinsicstate);
    
    FlyWeight fy = f.getFlyWeight("y");
    fx.operation(--extrinsicstate);
    
    FlyWeight uf = new UnsharedConcreteFlyWeight();
    uf.operation(--extrinsicstate);
}
```

