---
title: 7.目标检测
tags:
  - 计算计视觉
categories: 人工智能
copyright: true
---

目标检测首先需要有一个类型的集合，只能检测集合中的类型，并且他会检测出图片中所有属于集合中的**类型和位置**。坐标可以使用极坐标或者中心点坐标表示。

模型的评价指标有2种：

1.   IoU(交并比)，检测结果和测试数据真实结果的交集/检测结果和真实结果的并集。
2.   mAP：IoU没有衡量检测类型准确性的指标，他是用精确率和召回率组成的PR图的面积表示。

**不管是单阶段提交算法还是两阶段提交算法都会产生多个候选框。**

#### 2. 两阶段提交算法

相比于单阶段多了一个预选操作，速度慢，效果好，适合离线检测。

##### 2.1 overheat

使用固定宽高的矩形区域滑动窗口，将窗口扫描的结果送到神经网络分类和回归。这种类似于穷举，会消耗大量算力，并且他的窗口大小固定，结果不是很准确。

##### 2.2 R-CNN

引入**区域建议**概念，将目标检测分为**候选区域提取 → 特征提取 → 分类**三步：

1.   候选区域提取：使用Selective Search(SS)算法在图像上生成约 2000 个候选区域（Region Proposals）。
2.   特征提取：将每个候选区域送入 CNN（如 AlexNet）中提取特征。
3.   分类：将提取的特征送入**SVM（支持向量机）**进行分类。
4.   边界框回归：使用**回归器**优化边界框的位置。

他的分类是传统机器学习而不是神经网络。缺点：每个候选区域都要单独经过CNN处理，速度慢；很多候选区域重叠，特征提取存在重复计算。

##### 2.3 fast R-CNN

改进点：

1.   使用全图卷积避免对每个候选框单独卷积，将候选区域映射到特征图上；
2.   通过 **ROI Pooling** 将不同大小的候选区域转换为固定大小；
3.   使用**全连接层**同时进行**分类**和**边界框回归**；

##### 2.4 faster R-CNN

改进点：使用RPN代替SS生成候选框。他是一个端到端的寻量模型，我们只需要**提供训练数据和对应的标签，调用预定义好的训练脚本即可，不关心模型的细节（如学习率、优化器、损失函数、中间特征层的设计等）。**

##### 2.5 Mask-Rcnn



#### 3. 单阶段提交算法

单阶段检测的速度快，精度低，适合实时检测，比如自动驾驶、无人机目标检测等。YOLO和SSD都是端到端的模型。

##### 3.1 YOLO

将输入的图片分成n个小格子，每个格子作为中心点，并且给2个尺寸的候选框，然后计算2个候选框的IOU和置信度，首先抛弃置信度过低的候选框，如果候选框没有被抛弃就选择IOU大的候选框进行微调，微调就是调整长宽，让他能够圈住检测的物体。微调的过程就是回归，所以YOLO的核心思想就是计算IOU+回归任务。如果最后的结果中1个点有很多预选框重叠了就采用NMS保留置信度最高的。

*   V1版本：有很多缺点，因为全连接层要求输入的特征树是固定的，所有V1版本的YOLO要求输入的图像大小是固定的；并且多个物体重叠或者物体过小时很难检测；
*   V2版本：舍弃Dropout，每层卷积后增加了Batch Normalization。因为V1使用224 \* 224的分辨率进行训练，比较小，V2版本在训练完之后使用448 \* 448的图片进行10次微调。V2中先验框的大小使用聚类算法确定，而不是写死的，数量也从2个变成5个。
*   V3版本：改进了网络结构，更适合小目标检测，去掉了池化层，通过残差网络实现3种scale，分别对应大、中、小3种目标。
*   V4版本：训练数据上增加了一些随机处理，比如翻转，遮盖，马赛克，DropBlock等；使用标签平滑方式(类别不设置成1，比如虽然是狗但是也要设置成0.95的狗+0.05的猫)防止过拟合；使用CIOU代替IOU；增加注意力机制、特征金字塔等；

##### 3.2 SSD

使用多尺度特征图进行预测，从不同尺度的特征图中检测不同大小的物体。在多个卷积层上进行预测，每层生成一组边界框和类别置信度。精度比YOLO高。

YOLO适合实时检测小物体，更适合视频分析、图像分类。

##### 3.3 DETR

基于transformer的算法，没有NMS，没有预选框。但是训练很慢，而且对输入的特征有限制，不能很大。

##### 3.4 DeformableDert

解决了DETR的输入特征限制和训练速度问题。

##### 3.5 EfficientNet

主要用来做图像分类，Google Research提出。

-   使用**复合缩放（Compound Scaling）**统一缩放网络的深度、宽度和分辨率。
-   在 ImageNet 数据集上取得了 SOTA（State-of-the-Art）的精度，同时参数量和计算量更少。
-   基础模型 EfficientNet-B0 到 B7 提供了不同规模的版本，适应不同计算需求。

##### 3.6 EfficientDet

基于 EfficientNet，使用加权双向特征金字塔网络。
