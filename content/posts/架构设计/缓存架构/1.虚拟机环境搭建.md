### 虚拟机安装

虚拟机管理软件：virtual box；

虚拟机镜像版本：CentOS-7-x86_64-Everything-1810；

安装完成后启动配置固定ip，由于不知道那些ip可以分配，所以先设置成动态获取，在把获取的ip设成固定的：

```shell
# 编辑ifcfg-eth0文件
vi /etc/sysconfig/network-scripts/ifcfg-eth0
```

```shell
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
# 动态ip
BOOTPROTO=dhcp
```

```shell
# 重启network服务
service network restart
#-->查看当前ip，比如192.168.0.3
ifconfig
```

再次编辑ifcfg-eth0文件

```shell
DEVICE=eth0
TYPE=Ethernet
ONBOOT=yes
# 静态ip
BOOTPROTO=static
IPADDR=192.168.0.3
NETMASK=255.255.255.0
GATEWAY=192.168.0.1
```

```shell
# 重启network服务
service network restart
```

关闭防火墙

```shell
# 查看防火墙状态
firewall-cmd --state
# 停止防火墙
systemctl stop firewalld.service
# 禁止防火墙开机启动
systemctl disable firewalld.service
```

配置yum

```shell
yum clean all
yum makecache
yum install wget
```

安装jdk

```shell
rpm -ivh jdk-8u11-linux-x64.rpm
```

配置jdk环境变量（我没配置）

```shell
vi ~/.bashrc
```

```shell
export JAVA_HOME=/usr/java/latest
export PATH=$PATH:$JAVA_HOME/bin
```

刷新之后（source ~/.bashrc）运行java -version查看版本

安装perl（以后的lua脚本会用到）

```shell
yum install -y gcc
wget http://www.cpan.org/src/5.0/perl-5.16.1.tar.gz
tar -xzf perl-5.16.1.tar.gz
cd perl-5.16.1
./Configure -des -Dprefix=/usr/local/perl
make && make test && make install
perl -v
```

在其他两个虚拟机进行相同操作，最后修改/etc/hosts文件，添加所有虚拟机的hostname和ip的映射，代码：

```shell
192.168.0.3 eshoop-cache01
192.168.0.5 eshoop-cache02
192.168.0.6 eshoop-cache03
```

### 设置三台虚拟机免密通信

首先在三台机器上配置对本机的ssh免密码登录，以eshoop-cache01为例

```shell
# 生成本机的公钥，过程中不断敲回车即可，ssh-keygen命令默认会将公钥放在/root/.ssh目录下
ssh-keygen -t rsa
cd /root/.ssh
# 将公钥复制为authorized_keys文件，此时使用ssh连接本机就不需要输入密码了
cp id_rsa.pub authorized_keys
```

分别配置两台机器ssh免密码登录

```shell
# 将本机的公钥拷贝到指定机器的authorized_keys文件中
ssh-copy-id -i eshoop-cache02
ssh-copy-id -i eshoop-cache03
```

在其他两台机器上进行相同操作