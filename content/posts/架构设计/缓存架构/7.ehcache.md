引入依赖：

```xml
<!-- ehcache -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-context-support</artifactId>
</dependency>
<dependency>
    <groupId>net.sf.ehcache</groupId>
    <artifactId>ehcache</artifactId>
</dependency>
```

添加配置文件ehcache.xml到resource目录下：

```xml
<?xml version="1.0" encoding="UTF-8"?>
<ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://ehcache.org/ehcache.xsd"
    updateCheck="false">

    <diskStore path="java.io.tmpdir/Tmp_EhCache" />

    <!-- eternal:缓存不过期，timeout不生效
         maxElementsInMemory：最多存多少个对象，这个自己估出来的，比如给ehcahce1M，每个对象平均1k，这样这个值大约就是1000
         overflowToDisk：如果内存不够是否溢出到磁盘
         diskPersistent：在jvm崩溃或者重启时是否开启磁盘持久化，使用磁盘就会变得很慢
         timeToIdleSeconds：对象的最大闲置时间，超过了就会过期
         timeToLiveSeconds：对象存活时间
         memoryStoreEvictionPolicy：当对象达到maxElementsInMemory时使用什么算法清除
     -->
    <defaultCache
        eternal="false"
        maxElementsInMemory="1000"
        overflowToDisk="false"
        diskPersistent="false"
        timeToIdleSeconds="0"
        timeToLiveSeconds="0"
        memoryStoreEvictionPolicy="LRU" />

    <!-- 手动指定的缓存策略，指定调用下面的local就不会使用上面的defaultCache -->
    <cache
        name="local"
        eternal="false"
        maxElementsInMemory="1000"
        overflowToDisk="false"
        diskPersistent="false"
        timeToIdleSeconds="0"
        timeToLiveSeconds="0"
        memoryStoreEvictionPolicy="LRU" />
</ehcache>
```

创建配置类：

```java
@Configuration
@EnableCaching
public class CacheConfiguration {
	@Bean
    public EhCacheManagerFactoryBean ehCacheManagerFactoryBean(){
      EhCacheManagerFactoryBean cacheManagerFactoryBean = new EhCacheManagerFactoryBean();
      cacheManagerFactoryBean.setConfigLocation(new ClassPathResource("ehcache.xml"));
      cacheManagerFactoryBean.setShared(true);
      return cacheManagerFactoryBean;
    }

    @Bean
    public EhCacheCacheManager ehCacheCacheManager(EhCacheManagerFactoryBean bean){
      return new EhCacheCacheManager(bean.getObject());
    }
}
```

简单使用：

```java
@Cacheable(value = CACHE_NAME, key = "'key_' + #id")
public ProductInfo getLocalCache(Long id) {
    // 返回null的时候会去ehcache中查找
    return null;
}
```

