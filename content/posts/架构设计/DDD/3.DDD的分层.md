---
title: DDD-3.DDD的分层架构
date: 2021-06-24 06:27:35
tags:
  - 研发效能
categories: DDD
copyright: true
---

目前没有一套完整的DDD方法论，他仅仅提供了一些思想，所以每个公司可能都有自己的DDD目录结构，一般都是用到他的概念和分层，有的简单业务甚至只用到他的分层。

推进DDD是很难的，第1花时间还没有产出，第2就是没有完整的方法论，包结构数据怎么流转等等都没有统一的规定。而且完全按照DDD的规范来开发不适合互联网，DDD讲究的是把聚合、值对象这些东西分的很细还有对以后扩展的预留，完全用这个会把开发周期拖长，对业务不熟或者赶工的时候非常容易走样。

### 一些普适性架构

##### 清洁架构

也叫洋葱架构，因为分层的图画出来很像洋葱：

![fc8208d9f4cfadb7949d6e98a8c18442](https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/fc8208d9f4cfadb7949d6e98a8c18442.webp)

越里层，越是核心能力，并且外圆只能依赖内圆，基础资源除外，或者说最外层除外。在DDD中4层架构的功能边界如下：

![006_图解四层架构功能边界](https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/006_图解四层架构功能边界.jpg)

传统4层架构的调用方式看起来像下面这样：

<img src="https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/Xnip2023-05-08_08-24-36.png" alt="Xnip2023-05-08_08-24-36" style="zoom:50%;" />

就很怪，为什么接口可以直接调用基础层，数据库什么的都在这里？？？

##### 六边形架构

也叫端口适配器架构，红框内是核心逻辑，核心逻辑不变采用适配器适配不同端，同理和基础架构的交互也是使用了依赖倒置，置于为什么叫6边型，是为了形容一套逻辑可以适配多个端口。

![6](https://raw.githubusercontent.com/wangxiaohong123/p-bed/main/uPic/6.webp)

四层架构里的接口层虽然有web界面这些东西，但是他定义的不是传统3层架构的controller，6变形架构就是为了解决这个问题，并且他把基础设施也定义成了api的方式提供其他层调用。