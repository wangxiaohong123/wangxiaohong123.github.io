<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>自研框架 on 王小红的笔记</title><link>https://wangxiaohong123.github.io/tags/%E8%87%AA%E7%A0%94%E6%A1%86%E6%9E%B6/</link><description>Recent content in 自研框架 on 王小红的笔记</description><generator>Hugo -- 0.150.0</generator><language>zh-CN</language><atom:link href="https://wangxiaohong123.github.io/tags/%E8%87%AA%E7%A0%94%E6%A1%86%E6%9E%B6/index.xml" rel="self" type="application/rss+xml"/><item><title>最终一致性框架</title><link>https://wangxiaohong123.github.io/posts/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E8%87%AA%E7%A0%94%E6%A1%86%E6%9E%B6/1.%E6%9C%80%E7%BB%88%E4%B8%80%E8%87%B4%E6%80%A7%E6%A1%86%E6%9E%B6/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://wangxiaohong123.github.io/posts/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E8%87%AA%E7%A0%94%E6%A1%86%E6%9E%B6/1.%E6%9C%80%E7%BB%88%E4%B8%80%E8%87%B4%E6%80%A7%E6%A1%86%E6%9E%B6/</guid><description>&lt;h5 id="rocketmq事务消息缺点"&gt;RocketMQ事务消息缺点&lt;/h5&gt;
&lt;p&gt;首先使用RocketMQ的事务消息会增加额外的代码，比如提交half失败，要实现mq定时回查的接口，最关键的是如果mq短时间故障，在业务开始之前创建half消息失败的时候就要返回系统异常，但是业务明明没问题，不应该让mq拖垮业务。&lt;/p&gt;
&lt;p&gt;因为mq问题导致数据库或者分布式事务全部回滚的强一致方案是没有容错性的，可以使用本地消息表代替事务消息，将发送失败的消息暂存，定时重试。&lt;/p&gt;
&lt;h5 id="框架的功能"&gt;框架的功能&lt;/h5&gt;
&lt;p&gt;有了软事务的框架后只要是非核心的动作(比如写redis、写MySQL、第三方接口调用等等)，如果不想让他们的失败拖垮核心链路都可以用本地消息表的方案解决，异常的非核心action操作一直重试就可以了。&lt;/p&gt;
&lt;p&gt;但是一些操作比如调三方可能需要延迟或者降级的操作，比如发送短信一个三方发送失败就去调另一个三方执行降级逻辑，所以框架还要有延迟、降级功能。&lt;/p&gt;
&lt;p&gt;如果重试到了最大次数还是失败怎么办？此时可能需要一个报警通知的功能。&lt;/p&gt;
&lt;p&gt;整体流程如下：
&lt;img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h116soskhoj20u01p0n24.jpg" style="zoom:100%;" /&gt;&lt;/p&gt;
&lt;h5 id="数据库结构"&gt;数据库结构：&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;"&gt;&lt;tr&gt;&lt;td style="vertical-align:top;padding:0;margin:0;border:0;"&gt;
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 1
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 2
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 3
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 4
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 5
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 6
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 7
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 8
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt; 9
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;10
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;11
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;12
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;13
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;14
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;15
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;16
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;17
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;18
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;19
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;20
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;21
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;22
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;23
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;24
&lt;/span&gt;&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%"&gt;
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-sql" data-lang="sql"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ff79c6"&gt;CREATE&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;TABLE&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;orderorigin_tend_consistency_task&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; (
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;id&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;bigint&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; AUTO_INCREMENT &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;主键自增&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;task_id&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;300&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;用户自定义的任务名称，如果没有则使用方法签名&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;task_status&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; tinyint &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;0&amp;#39;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;执行状态&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;execute_times&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;int&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;执行次数&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;execute_time&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;bigint&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;预计执行时间&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;parameter_types&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;255&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;参数的类路径名&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;method_name&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;100&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;方法名&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;method_sign_name&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;300&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;方法签名&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;execute_interval_sec&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;int&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;60&amp;#39;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;执行间隔&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;delay_time_sec&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;int&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;60&amp;#39;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;延迟时间&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;task_parameter&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;200&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;方法参数&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;performance_way&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; tinyint &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;执行模式：1、立即执行 2、调度执行&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;thread_way&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; tinyint &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;线程模型 1、异步 2、同步&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;ensure_idem&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;bit&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;幂等性保证&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;error_msg&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;200&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;执行的error信息&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;alert_expression&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;100&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;告警表达式&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;alert_action_bean_name&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;255&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;告警逻辑的的执行beanName&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;fallback_class_name&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;255&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;降级逻辑的的类路径&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;fallback_error_msg&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; &lt;span style="color:#8be9fd;font-style:italic"&gt;varchar&lt;/span&gt;(&lt;span style="color:#bd93f9"&gt;200&lt;/span&gt;) &lt;span style="color:#8be9fd;font-style:italic"&gt;CHARACTER&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;SET&lt;/span&gt; utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt; utf8mb4_general_ci &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;降级失败时的错误信息&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;created_time&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; datetime &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;创建时间&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;modified_time&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; datetime &lt;span style="color:#ff79c6"&gt;NOT&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;NULL&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;COMMENT&lt;/span&gt; &lt;span style="color:#f1fa8c"&gt;&amp;#39;修改时间&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;PRIMARY&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;KEY&lt;/span&gt; (&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;id&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#ff79c6"&gt;INDEX&lt;/span&gt; &lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;nk_status_execute_time_key&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt; (&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;task_status&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;,&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;execute_time&lt;span style="color:#ff79c6"&gt;`&lt;/span&gt;) &lt;span style="color:#ff79c6"&gt;USING&lt;/span&gt; BTREE
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;) ENGINE&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;InnoDB &lt;span style="color:#ff79c6"&gt;DEFAULT&lt;/span&gt; CHARSET&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;utf8mb4 &lt;span style="color:#ff79c6"&gt;COLLATE&lt;/span&gt;&lt;span style="color:#ff79c6"&gt;=&lt;/span&gt;utf8mb4_general_ci;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id="执行任务逻辑"&gt;执行任务逻辑&lt;/h5&gt;
&lt;p&gt;任务状态：0 初始化；1 执行失败；2 执行中；3 执行成功；&lt;/p&gt;</description></item></channel></rss>